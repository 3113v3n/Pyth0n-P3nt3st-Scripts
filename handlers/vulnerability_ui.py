from .file_handler import FileHandler


class VulnerabilityInterface:
    def __init__(self) -> None:

        pass

    def user_interaction(validator, color, filemanager: FileHandler):
        print("Running Vulnerability Analysis Module\n")

        while True:

            try:
                search_dir = input(
                    "\nEnter Location Where your files are located \n"
                ).strip()
                if not validator.check_folder_exists(search_dir):
                    raise ValueError("No Such Folder exists")

                files_tuple = filemanager.display_saved_files(
                    search_dir, display_csv=True
                )

                if files_tuple:
                    # Display all available CSV files

                    output_filename = input(
                        "[+] Provide a name for your output file: "
                    ).strip()

                    return {
                        "input_file": files_tuple,  # input_filename,
                        "output": output_filename,
                    }
                else:
                    raise FileExistsError("No Files Present in the provided Directory")

            except (FileExistsError, ValueError) as error:
                print(f"{color.FAIL}\n[!]{error}{color.ENDC}")
